/*Selecciono los registros a borrar*/
select * from Custodia..InfFIFO_Op 
where MinManual in (6477566, 6496995, 6586120)
order by FchOrg,MinManual

/*Borro los registros seleccionados*/

delete from Custodia..InfFIFO_Op 
where MinManual in (6477566, 6496995, 6586120)

/*Luego de las modificaciones ejecuto el SP*/
EXEC SP_TENENCIA_FIFO

/*Saco las Especies valorizadas para el Excel*/
select * from Custodia..InfFIFO_ValorizadoxEsp order by Abrev 


/*********************REVERSA************************/
INSERT INTO PROD..InfFIFO_Op
      (Tr
      ,MinManual
      ,FchOrg
      ,Tipo
      ,CPpal
      ,EspPago
      ,PrecioPesificado
      ,Valorizado)
VALUES
      ('TDG24', 6477566, '2023-07-24 00:00:00.000', 'Cmp', 250000, '$', 294.103, 294.103),
      ('TDG24', 6496995, '2023-08-11 00:00:00.000', 'Vnta', 509892, '$', 349.5, 349.5),
      ('X20F4', 6586120, '2023-11-15 00:00:00.000', 'Cmp', 44040000, '$', 1.2135, 1.2135);


/*Modificaciones */

USE Custodia;

INSERT INTO Custodia..InfFIFO_Op (Tr,MinManual,FchOrg,Tipo,CPpal,EspPago,Precio,Valorizado)
VALUES
('TDG24',9614427,'20231110','Vnta',5000000,'$',575.30,575.30),
('GD30' ,9612893,'20230518','Cmp',1546402,'$',175.22,175.22),
('X20F4',6598183,'20231113','Cmp',4718927,'$',1.26,1.26),
('TV24D',6577772,'20231018','Vnta',12017805,'$',463.05,463.05),
('T2X4N',2149919,'20230831','Vnta',30000000,'$',4.1445,4.1445),
('T2X4N',2149918,'20230831','Cmp',30000000,'$',4.14472,4.14472),
('T2X4N',2149922,'20230831','Vnta',30000000,'$',4.1445,4.1445),
('T2X4N',2151610,'20231117','Vnta',7000000,'$',5.13422,5.13422),
('T2X4N',2151611,'20231118','Cmp',7000000,'$',5.19035,5.19035)


SELECT * FROM Custodia..InfFIFO_Op
WHERE MinManual = 9573117
AND Tr = 'MGCBO'

DELETE FROM Custodia..InfFIFO_Op
WHERE MinManual = 9573117
AND Tr = 'MGCBO'

/*
INGRESO
Tr      MinManual   Cliente                 FchOrg      Tipo     CPpal      EspPago  Precio         Valorizado
TDG24   9614427     CARTERA ITAU            2023-11-10  Vta      5000000    $        575.30         575.30
GD30    9612893     HEIMANN MARCELO RUBEN   2023-05-18  Cmp      1546402    $        175.22         175.22
X20F4   6598183     JORGE ANTONIO MARTINEZ  2023-11-13  Cmp      4718927    $        1.26           1.26
TV24D   6577772     GARCIA HOEFFLER EDGARDO 2023-10-18  Vta      12017805   $        463.05         463.05
T2X4N   2149919     BCO HIPOTECARIO         2023-08-31  Vta      30000000   $        4.1445         4.1445
T2X4N   2149918     BCO HIPOTECARIO         2023-08-31  Cmp      30000000   $        4.1447271      4.1447271
T2X4N   2149922     CITIBANK                2023-08-31  Vta      30000000   $        4.1445         4.1445
T2X4N   2151610     BCO.PATAGONIA SUD.SA    2023-11-17  Vta      7000000    $        5.134226       5.134226
T2X4N   2151611     BCO.PATAGONIA SUD.SA    2023-11-18  Cmp      7000000    $        5.19035083     5.19035083

EGRESO
MGCBO   9573117     20230715    Cmp 630839354   $   1
*/

--OPERACIONES PARA INGRESAR SEGUN EXCEL

SELECT EspPpal AS Tr,
       MinManual,
       FchOrg,
       FchVnc,
       Cliente,
       Tipo,
       CPpal,
       EspPago,
       Precio,
       Precio AS PrecioPesificado,
       Precio AS Valorizado,
       EstadoCod,
       Tr AS TrEsp 
from PROD..VW_OPERACIONES_ALL
where MinManual in (
6586086,2145882,2145823,2145666,2145812,2145810,2145834,2145821,2145558,2145590,2145433,2145529,2145510,2145475,2145621,
2145761,2145589,2145881,2145474,2145932,2145528,2145831,2145832,2145820,2145557,2145665,2145809,2145833,2145549,2145434,
2145622,2145811,2145822,2145511,2145700,2145760,2145931,2145699,2145548,6587823,6463436,2149981,2149979,2149980,2149978,
6594726,2151354,6584541,6584559,2151353,6600481,6600505,2149247,2151197,2149148,2145140,2146687,2144808,2144636,2144617,
2144947,2144642,2144766,2145146,2144619,2146532,2150463,2149102,2149056,2149191,2149324,2151320,2149354,2149077,2149075,
2149234,2149232,2149641,2149644,2151382,2149635,2149182,2149015,2149356,2150385,2149353,2149740,2150272,2149561,2150152,
2150201,2150043,2151229,2149963,2150416,2151233,2151394,2150068,2151224,2151257,2150856,2151180,2151240,2150733,2151255,
2151038,2150962,2150696,2151002,2151185,2150618,2151262,2151314,2151029,2151422,2151195,2151419,2151413,2151328,2151208,
2151416,2151432,2151434,2151451,2151449,2149640,2144616,2149355,2149323,2150732,2144807,2149147,2150695,2150617,2146686,
2151179,2144641,2149246,2148016,2147901,2151261,2150384,2150271,2151412,2148532,2144635,2147899,2149643,2148495,2148494,
2148492,2151688,2148531,2147924,2147900,2148621,2147921,2149962,2144618,2145139,2149192,2149739,2149101,2151239,2149231,
2149074,2151037,2150855,2150961,2146531,2149560,2151327,2150042,2150151,2150067,2148497,2145145,2151028,2151254,2151450,
2148166,2148165,2148620,2147922,2147896,2148493,2148364,2147897,2149634,2151196,2149076,2144946,2149055,2151207,2151256,
2151421,2151381,2150200,2150462,2151433,2148017,2147923,2151194,2151228,2151448,2150415,2151223,2151418,2151313,2151393,
2151319,2151431,2151184,2149181,2151001,2149233,2149014,2144765,2147898,2148343,2148365,2148342,2151689,2151232,2151415,
2148496,6608621,6608679,6608683,6608693,6608691,6608635,6608695,6608645,2150905,2150582,2150610,2150903,2150507,2149861,
2150358,2149881,2151063,2150545,2150509,2151016,2150612,2151447,2151364,2151462,6599553,6599445,6599549,6599351,6599409,
6599441,6599449,6599439,6599435,6599389,6599463,6599555,6599443,6600413,6598343,6600400,6598341,6600389,6600419,6600523,
6600529,6600415,6600402,6600527,6606607,2151015,2150611,2149880,2150357,2149860,2150508,2150546,2150904,2150613,2150583,
2150906,2151062,2150506,2151446,2151461,2151365
)

--EXEC sp_columns @table_name = 'InfFIFO_Op';
